<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Git Rev News 45 - Even - A super concise theme for Hugo</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="berger7" /><meta name="description" content="æœ¬æ–‡æ¥è‡ªgitç¤¾åŒºçš„rev newsï¼ŒåŸæ–‡åœ°å€è§æ­¤ åˆ†äº«å¯¼è¯» æœ¬æœŸå†…å®¹è¦†ç›–äº†gitç¤¾åŒº2018å¹´10æœˆå‘ç”Ÿçš„äº‹æƒ…. æœ¬æœŸå»¶ç»­å¾€æœŸçš„ç»“æ„ï¼Œæ ¹æ®æœ¬äººé˜…è¯»" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.54.0 with even 4.0.0" />


<link rel="canonical" href="http://localhost:1313/post/git-rev-news-45/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.ed55b616.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Git Rev News 45" />
<meta property="og:description" content="æœ¬æ–‡æ¥è‡ªgitç¤¾åŒºçš„rev newsï¼ŒåŸæ–‡åœ°å€è§æ­¤ åˆ†äº«å¯¼è¯» æœ¬æœŸå†…å®¹è¦†ç›–äº†gitç¤¾åŒº2018å¹´10æœˆå‘ç”Ÿçš„äº‹æƒ…. æœ¬æœŸå»¶ç»­å¾€æœŸçš„ç»“æ„ï¼Œæ ¹æ®æœ¬äººé˜…è¯»" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/git-rev-news-45/" />
<meta property="article:published_time" content="2019-01-20T16:20:52&#43;08:00"/>
<meta property="article:modified_time" content="2019-01-20T16:20:52&#43;08:00"/>

<meta itemprop="name" content="Git Rev News 45">
<meta itemprop="description" content="æœ¬æ–‡æ¥è‡ªgitç¤¾åŒºçš„rev newsï¼ŒåŸæ–‡åœ°å€è§æ­¤ åˆ†äº«å¯¼è¯» æœ¬æœŸå†…å®¹è¦†ç›–äº†gitç¤¾åŒº2018å¹´10æœˆå‘ç”Ÿçš„äº‹æƒ…. æœ¬æœŸå»¶ç»­å¾€æœŸçš„ç»“æ„ï¼Œæ ¹æ®æœ¬äººé˜…è¯»">


<meta itemprop="datePublished" content="2019-01-20T16:20:52&#43;08:00" />
<meta itemprop="dateModified" content="2019-01-20T16:20:52&#43;08:00" />
<meta itemprop="wordCount" content="5173">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Git Rev News 45"/>
<meta name="twitter:description" content="æœ¬æ–‡æ¥è‡ªgitç¤¾åŒºçš„rev newsï¼ŒåŸæ–‡åœ°å€è§æ­¤ åˆ†äº«å¯¼è¯» æœ¬æœŸå†…å®¹è¦†ç›–äº†gitç¤¾åŒº2018å¹´10æœˆå‘ç”Ÿçš„äº‹æƒ…. æœ¬æœŸå»¶ç»­å¾€æœŸçš„ç»“æ„ï¼Œæ ¹æ®æœ¬äººé˜…è¯»"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Berger7</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Berger7</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Git Rev News 45</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-01-20 </span>
        <div class="post-category">
            <a href="/categories/git/"> git </a>
            <a href="/categories/news/"> news </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#åˆ†äº«å¯¼è¯»">åˆ†äº«å¯¼è¯»</a></li>
<li><a href="#åˆ†äº«æ­£æ–‡">åˆ†äº«æ­£æ–‡</a>
<ul>
<li><a href="#ç¤¾åŒºè®¨è®º">ç¤¾åŒºè®¨è®º</a>
<ul>
<li><a href="#commit-graph-is-cool">commit-graph is cool</a></li>
</ul></li>
<li><a href="#commit-graphçš„æ‰©å±•">commit-graphçš„æ‰©å±•</a>
<ul>
<li><a href="#ä»€ä¹ˆæ˜¯commit-graph">ä»€ä¹ˆæ˜¯commit-graph</a></li>
<li><a href="#commit-graphçš„è®¾è®¡">commit-graphçš„è®¾è®¡</a>
<ul>
<li><a href="#è¯¦è¯»è®¾è®¡æ–‡æ¡£">è¯¦è¯»è®¾è®¡æ–‡æ¡£</a></li>
</ul></li>
</ul></li>
<li><a href="#å…¶ä»–æ–°é—»">å…¶ä»–æ–°é—»</a>
<ul>
<li><a href="#git-submodule-æ¼æ´">Git submodule æ¼æ´</a></li>
</ul></li>
<li><a href="#è¯»ç‰©">è¯»ç‰©</a>
<ul>
<li><a href="#è¯¥æ­»çš„git">è¯¥æ­»çš„Git</a></li>
<li><a href="#å¯¹å¼€æºè½¯ä»¶ç»´æŠ¤è€…æœ‰ç”¨çš„20ä¸ªå·¥å…·">å¯¹å¼€æºè½¯ä»¶ç»´æŠ¤è€…æœ‰ç”¨çš„20ä¸ªå·¥å…·</a></li>
<li><a href="#å¦‚ä½•é«˜æ•ˆçš„ä½¿ç”¨git">å¦‚ä½•é«˜æ•ˆçš„ä½¿ç”¨Git</a></li>
</ul></li>
<li><a href="#gitå·¥å…·å’Œç›¸å…³ç½‘ç«™">gitå·¥å…·å’Œç›¸å…³ç½‘ç«™</a>
<ul>
<li><a href="#git-fire">git-fire</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<p>æœ¬æ–‡æ¥è‡ªgitç¤¾åŒºçš„rev newsï¼Œ<a href="https://git.github.io/rev_news/2018/11/21/edition-45/">åŸæ–‡åœ°å€è§æ­¤</a></p>

<h2 id="åˆ†äº«å¯¼è¯»">åˆ†äº«å¯¼è¯»</h2>

<blockquote>
<p>æœ¬æœŸå†…å®¹è¦†ç›–äº†gitç¤¾åŒº2018å¹´10æœˆå‘ç”Ÿçš„äº‹æƒ….</p>
</blockquote>

<p>æœ¬æœŸå»¶ç»­å¾€æœŸçš„ç»“æ„ï¼Œæ ¹æ®æœ¬äººé˜…è¯»ï¼Œç­›é€‰å‡ºä¸ªäººè®¤ä¸ºä»·å€¼æ¯”è¾ƒå¤§çš„æœ‰ï¼š</p>

<ol>
<li>git commit-graphçš„åŸç†æ¦‚è§ˆï¼ˆcommit-graphå¦‚ä½•è®©merge-baseç®—çš„æ›´å¿«ï¼‰</li>
<li>git submoduleæ¼æ´çš„åˆ†æ</li>
<li>gitè¯¯æ“ä½œçš„6ä¸ªå›æ»šå°æŠ€å·§</li>
<li>åœ¨çªå‘æƒ…å†µä¸‹å¦‚ä½•ä¿æŠ¤å­˜åœ¨ä½ æœ¬åœ°çš„å…¬å¸ä»£ç è´¢äº§</li>
<li>ä¸€äº›gitå°èµ„è®¯</li>
</ol>

<p><em>å£°æ˜ï¼šä»¥ä¸‹å†…å®¹ç»è¿‡ä¸ªäººç¿»è¯‘ç†è§£ååšç¬”è®°æ•´ç†ï¼Œå†…å®¹å¯èƒ½æœ‰è¯¯ï¼Œæ¬¢è¿æ‹ç –ã€‚</em></p>

<h2 id="åˆ†äº«æ­£æ–‡">åˆ†äº«æ­£æ–‡</h2>

<h3 id="ç¤¾åŒºè®¨è®º">ç¤¾åŒºè®¨è®º</h3>

<h4 id="commit-graph-is-cool">commit-graph is cool</h4>

<p>èµ·å› æ˜¯ç¤¾åŒºçš„ä¸€ä¸ªå¤§ä½¬Elijahä¸ŠæŠ¥äº†ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯é¦–å…ˆæ˜¯ç§°èµcommit-graphå¯¹å¤§ä»“åº“åœ¨pushæ—¶å€™çš„ä½œç”¨
ç¡®å®æœ‰æ•ˆï¼Œä½†æ˜¯ä»–ä»”ç»†è°ƒæŸ¥åå‘ç°è¿™ç§åœºæ™¯ä¸‹æ²¡æœ‰å½»åº•çš„è§£å†³followTagsæ‰“å¼€åå˜æ…¢çš„æ ¹æœ¬åŸå› ï¼Œä»–è®¤ä¸ºå˜æ…¢
çš„æ ¹æœ¬åŸå› æ˜¯ï¼š<code>add_missing_tags()</code> æ–¹æ³•å¯¹æ¯ä¸ªtagéƒ½ä¼šè°ƒç”¨ä¸€æ¬¡<code>in_merge_bases_many()</code></p>

<p>commit-graphçš„ä½œè€…Stoleeéšåè·Ÿè¿›è¿™ä¸ªé—®é¢˜ï¼Œå¹¶æ‰“äº†å‡ ä¸ªå°patchä¿®å¤äº†è¿™ä¸ªé—®é¢˜ï¼š
<a href="https://github.com/gitgitgadget/git/pull/60/files">ä¿®å¤åpatchåœ°å€</a></p>

<h3 id="commit-graphçš„æ‰©å±•">commit-graphçš„æ‰©å±•</h3>

<h4 id="ä»€ä¹ˆæ˜¯commit-graph">ä»€ä¹ˆæ˜¯commit-graph</h4>

<p>å…ˆè¯´è¯´æˆ‘ä»¬å•¥æ—¶å€™ä¼šç”¨åˆ°commitçš„graphï¼š</p>

<ol>
<li>è®¡ç®—merge-baseçš„æ—¶å€™ï¼Œè¿™ä¸ªåŠŸèƒ½æˆ‘ä»¬åœ¨codereviewçš„æ—¶å€™ä¼šç”¨åˆ°</li>
<li>ç»˜åˆ¶æäº¤çš„å›¾è¡¨æ—¶å€™ä¼šç”¨åˆ°ï¼ˆæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªä»“åº“ä¸­æ‰§è¡Œ<code>git log --graph</code>ï¼‰</li>
</ol>

<p>åœ¨æ²¡æœ‰åšcommit-graphè¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œgitæ˜¯é€šè¿‡è®¡ç®—oidçš„parentså…³ç³»ï¼Œç„¶åé€’å½’çš„ç»˜åˆ¶ä¸€å¼ graphï¼Œå½“ç„¶ç”±äºæ˜¯gitæ˜¯
ç”¨cç¼–å†™çš„ï¼Œæ‰€ä»¥æ€§èƒ½å¯¹äºä¸€èˆ¬ä»“åº“ï¼ˆæäº¤åœ¨10wä¸€ä¸‹ï¼‰è¿˜æ˜¯okçš„ã€‚ä½†æ˜¯å¯¹ä¸€ä¸ªç‰¹åˆ«çš„å¤§çš„ä»“åº“ï¼Œæ¯”å¦‚ä¸Šæ–‡ä¸€å¼€å§‹æåˆ°çš„ä»“åº“ï¼Œå°±
ä¼šå¾ˆæ…¢ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç›’é©¬çš„ä¸€ä¸ªåº“æ¥æµ‹è¯•ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># åœ¨æœªå¯ç”¨commitGraphåŠŸèƒ½çš„æ—¶å€™ï¼Œè®¡ç®—bugfix-20181221å’Œmasterçš„merge base</span>
<span class="o">[</span>I<span class="o">]</span> âœ <span class="nb">time</span> git merge-base bugfix-20181221 master
5b6d3912afce2a43f99f7ee7f259f00cd08d884c
<span class="nv">LANG</span><span class="o">=</span>en_US git merge-base bugfix-20181221 master  <span class="m">0</span>.07s user <span class="m">0</span>.03s system <span class="m">96</span>% cpu <span class="m">0</span>.110 total

<span class="c1"># å¼€å¯commitGraphçš„åŠŸèƒ½</span>
<span class="o">[</span>I<span class="o">]</span> âœ git config core.commitGraph <span class="nb">true</span>

<span class="c1"># å¼€å¯commitGraphåŠŸèƒ½åå†æ¬¡è¿è¡Œ</span>
<span class="o">[</span>I<span class="o">]</span> âœ <span class="nb">time</span> git merge-base bugfix-20181221 master
5b6d3912afce2a43f99f7ee7f259f00cd08d884c
<span class="nv">LANG</span><span class="o">=</span>en_US git merge-base bugfix-20181221 master  <span class="m">0</span>.01s user <span class="m">0</span>.03s system <span class="m">93</span>% cpu <span class="m">0</span>.041 total

<span class="c1"># å…³é—­commitGraphçš„åŠŸèƒ½</span>
<span class="o">[</span>I<span class="o">]</span> âœ git config core.commitGraph <span class="nb">false</span>

<span class="c1"># å…³é—­commitGraphåŠŸèƒ½åå†æ¬¡è¿è¡Œ</span>
<span class="o">[</span>I<span class="o">]</span> âœ <span class="nb">time</span> git merge-base bugfix-20181221 master
5b6d3912afce2a43f99f7ee7f259f00cd08d884c
<span class="nv">LANG</span><span class="o">=</span>en_US git merge-base bugfix-20181221 master  <span class="m">0</span>.07s user <span class="m">0</span>.04s system <span class="m">96</span>% cpu <span class="m">0</span>.112 total</code></pre></td></tr></table>
</div>
</div>
<p>æ—¶é—´å·®è·åŸºæœ¬ä¸Šåœ¨ä¸€èˆ¬ä¸€ä¸Šï¼Œè¯æ˜commitGraphå¯¹äºè¾ƒå¤§ä»“åº“æ¥è¯´ï¼Œè¿˜æ˜¯éå¸¸æœ‰æ•ˆçš„ã€‚</p>

<p>å¯¹äºæ€§èƒ½ğŸš€æå‡çš„é—®é¢˜ï¼Œè°éƒ½å…ä¸äº†ä¼šéå¸¸æ„Ÿå…´è¶£ï¼Œå› æ­¤ç»§ç»­è¯¦ç»†äº†è§£ä¸‹commit-graphçš„å®ç°ã€‚</p>

<h4 id="commit-graphçš„è®¾è®¡">commit-graphçš„è®¾è®¡</h4>

<p>Gitç¤¾åŒºæœ‰ä¸ªå¾ˆå¥½çš„ä¹ æƒ¯æ˜¯ï¼Œä»–ä»¬å·²å®ç°çš„è®¾è®¡æ–‡æ¡£ï¼Œéƒ½ä¿å­˜åœ¨ä»“åº“é‡Œï¼Œè€Œä¸”è¡Œæ–‡éå¸¸çš„ç®€æ´è§„èŒƒï¼Œä»¤äººé’¦ä½©ã€‚</p>

<p><a href="https://github.com/git/git/blob/master/Documentation/technical/commit-graph.txt">æ–‡æ¡£åœ°å€é“¾æ¥é™„ä¸Š</a></p>

<h5 id="è¯¦è¯»è®¾è®¡æ–‡æ¡£">è¯¦è¯»è®¾è®¡æ–‡æ¡£</h5>

<p>Git Commit Graph Design Notes</p>

<p>gitéœ€è¦éå†commitå›¾çš„åŸå› ï¼Œæœ‰å¾ˆå¤šï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š</p>

<ol>
<li>ç›‘å¬å’Œè¿‡æ»¤æäº¤å†å²</li>
<li>è®¡ç®—merge base</li>
</ol>

<p>éšç€ä»“åº“çš„æäº¤æ¬¡æ•°å˜å¤šï¼Œè¿™äº›éå†çš„æ“ä½œä¼šè¶Šæ¥è¶Šæ…¢ã€‚å¯¼è‡´å˜æ…¢çš„åŸå› ä¸»è¦æœ‰ä¸‹é¢ä¸¤ä¸ªï¼š</p>

<ol>
<li>è§£å‹ç¼©ä»¥åŠåˆ†ææäº¤ä¿¡æ¯ï¼ˆgitæ˜¯å‹ç¼©å­˜å‚¨ï¼‰</li>
<li>éå†æ‰€æœ‰çš„å›¾ä»¥æ»¡è¶³æ‹“æ‰‘æ’åºçš„çº¦æŸ</li>
</ol>

<p>commit-graphæ–‡ä»¶æ˜¯ç”¨æ¥åŠ é€Ÿéå†æäº¤å›¾çš„æ•°æ®ç»“æ„ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯é€šè¿‡core.commitGraph
æ¥åšå¼€å…³ç¡®å®šæ˜¯å¦å¯ç”¨commitGraphçš„åŠŸèƒ½ã€‚é»˜è®¤ä¸å¼€å¯ï¼Œè€Œæ˜¯ä½¿ç”¨ODBè¿›è¡Œè®¡ç®—ï¼ˆå³ç”¨oidè¿›
è¡Œè®¡ç®—ï¼‰ã€‚commit-graphæ–‡ä»¶å­˜å‚¨åœ¨.gitç›®å½•ä¸‹çš„objects/infoç›®å½•ä¸‹ã€‚</p>

<p>The commit-graph file stores the commit graph structure along with some
extra metadata to speed up graph walks. By listing commit OIDs in lexi-
cographic order, we can identify an integer position for each commit and
refer to the parents of a commit using those integer positions. We use
binary search to find initial commits and then use the integer positions
for fast lookups during the walk.</p>

<p>A consumer may load the following info for a commit from the graph:</p>

<ol>
<li>The commit OID.</li>
<li>The list of parents, along with their integer position.</li>
<li>The commit date.</li>
<li>The root tree OID.</li>
<li>The generation number (see definition below).</li>
</ol>

<p>Values 1-4 satisfy the requirements of parse_commit_gently().</p>

<p>Define the &ldquo;generation number&rdquo; of a commit recursively as follows:
ä»¥é€’å½’çš„æ–¹å¼æ¥å®šä¹‰â€œä»£æ•°â€ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>

<ul>
<li>A commit with no parents (a root commit) has generation number one.
ä¸€ä¸ªæ²¡æœ‰çˆ¶commitï¼ˆæ ¹commitï¼‰çš„commitæœ‰ä»£æ•°ä¸º1</li>
<li>A commit with at least one parent has generation number one more than
the largest generation number among its parents.
ä¸€ä¸ªæ‹¥æœ‰è‡³å°‘ä¸€ä¸ªçˆ¶commitçš„commitçš„ä»£æ•°å€¼æ˜¯å…¶çˆ¶commitåŠ 1</li>
</ul>

<p>Equivalently, the generation number of a commit A is one more than the
length of a longest path from A to a root commit. The recursive definition
is easier to use for computation and observing the following property:</p>

<p>ç­‰ä»·çš„ï¼Œcommit Açš„ä»£å·è¦æ¯”ä»Aåˆ°æ ¹commitçš„æœ€é•¿è·¯å¾„è¦å¤š1. è¿™ä¸ªé€’å½’çš„å®šä¹‰ä½¿å¾—è§‚å¯Ÿä»¥ä¸‹å±æ€§
å˜å¾—å¾ˆæ–¹ä¾¿ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></pre></td>
<td class="lntd">
<pre class="chroma">If A and B are commits with generation numbers N and M, respectively,
and N &lt;= M, then A cannot reach B. That is, we know without searching
that B is not an ancestor of A because it is further from a root commit
than A.

å¦‚æœAå’ŒBåˆ†åˆ«ç”¨æˆ·ä¸¤ä¸ªä»£æ•°Nå’ŒMï¼Œä¸”N&lt;=Mï¼Œé‚£ä¹ˆAä¸ç­‰åˆ°è¾¾Bã€‚
ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸ç”¨æœç´¢Bæ˜¯ä¸æ˜¯Açš„ä¸€ä¸ªç¥–å…ˆå°±å¯ä»¥ç›´æ¥åˆ¤æ–­â€”â€”ä¸æ˜¯ï¼Œå› ä¸ºBæ¯”Aè·ç¦»æ ¹commitæ›´è¿œã€‚

Conversely, when checking if A is an ancestor of B, then we only need
to walk commits until all commits on the walk boundary have generation
number at most N. If we walk commits using a priority queue seeded by
generation numbers, then we always expand the boundary commit with highest
generation number and can easily detect the stopping condition.

ç›¸åçš„ï¼Œå½“éœ€è¦æ£€æŸ¥Aæ˜¯å¦ä¸ºBçš„ç¥–å…ˆæ—¶ï¼Œæˆ‘ä»¬åªç”¨éå†commitsç›´åˆ°æ‰€æœ‰çš„éå†è¾¹ç•Œä¸Šçš„commitçš„
ä»£æ•°éƒ½æ¯”Nè¦å¤§æˆ–è€…ç›¸ç­‰ã€‚å¦‚æœæˆ‘ä»¬éå†çš„æ—¶å€™ä½¿ç”¨ä¸€ä¸ªæ ¹æ®ä»£æ•°æ¥æ’å…¥çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆé¡¶ç«¯æ€»æ˜¯
æœ€å°çš„ä»£æ•°çš„commitï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€»æ˜¯ç”¨æœ€é«˜ä»£æ•°æ¥æ‰©å±•è¾¹ç•Œçš„commitï¼Œå› æ­¤å¯ä»¥å¾ˆå®¹æ˜“çš„æ¢æµ‹åˆ°
åœæ­¢æ¡ä»¶ã€‚</pre></td></tr></table>
</div>
</div>
<p>This property can be used to significantly reduce the time it takes to
walk commits and determine topological relationships. Without generation
numbers, the general heuristic is the following:</p>

<p>è¿™ä¸ªä¼˜å…ˆçº§å¯ä»¥ç”¨æ¥æ˜¾è‘—çš„å‡å°‘éå†commitså’Œç¡®å®šæ‹“æ‰‘å…³ç³»æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚å¦‚æœæ²¡æœ‰ä»£æ•°ï¼Œé‚£ä¹ˆ
é€šå¸¸çš„å¯å‘å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">If A and B are commits with commit time X and Y, respectively, and
X &lt; Y, then A _probably_ cannot reach B.

å¦‚æœAå’ŒBçš„æ˜¯ä¸¤ä¸ªåˆ†åˆ«åœ¨Xå’ŒYæ—¶é—´æäº¤çš„commitsï¼Œå¦‚æœX&lt;Yï¼Œé‚£ä¹ˆAå¯èƒ½ä¸èƒ½åˆ°è¾¾Bã€‚</pre></td></tr></table>
</div>
</div>
<p>This heuristic is currently used whenever the computation is allowed to
violate topological relationships due to clock skew (such as &ldquo;git log&rdquo;
with default order), but is not used when the topological order is
required (such as merge base calculations, &ldquo;git log &ndash;graph&rdquo;).</p>

<p>è¿™ç§å¯å‘å¼å½“å‰è¢«ä½¿ç”¨åœ¨ï¼Œå…è®¸ç”±äºæ—¶é’Ÿå·®å¯¼è‡´è€Œå¯¼è‡´è¿åæ‹“æ‰‘å…³ç³»çš„è®¡ç®—ä¸­ï¼ˆæ¯”å¦‚ä½¿ç”¨é»˜è®¤æ’åº
çš„git logï¼‰ï¼Œä½†æ˜¯è¢«è¦æ±‚å¿…é¡»ä»¥æ‹“æ‰‘æ¥æ’åºçš„æ—¶å€™ï¼Œè¿™ç§å¯å‘å¼å°±ä¸èƒ½è¢«ä½¿ç”¨ï¼ˆå¦‚æœåœ¨merge
baseçš„è®¡ç®—ä¸­ã€â€œgit log &ndash;graphâ€ï¼‰</p>

<p>In practice, we expect some commits to be created recently and not stored
in the commit graph. We can treat these commits as having &ldquo;infinite&rdquo;
generation number and walk until reaching commits with known generation
number.</p>

<p>åœ¨å®é™…ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€äº›æœ€è¿‘è¢«åˆ›å»ºçš„commitsï¼Œè¿™äº›commitæ²¡æœ‰å­˜åœ¨commit-graphæ–‡ä»¶ä¸­ã€‚
æˆ‘ä»¬å½“è¿™äº›commitsè®¤ä¸ºæ˜¯æ‹¥æœ‰â€œæ— é™â€ä»£æ•°ï¼Œéå†commitsç›´åˆ°é‡åˆ°å·²çŸ¥ä»£æ•°çš„commitã€‚</p>

<p>We use the macro GENERATION_NUMBER_INFINITY = 0xFFFFFFFF to mark commits not
in the commit-graph file. If a commit-graph file was written by a version
of Git that did not compute generation numbers, then those commits will
have generation number represented by the macro GENERATION_NUMBER_ZERO = 0.</p>

<p>æˆ‘ä»¬ç”¨GENERATION_NUMBER_INFINITY = 0xFFFFFFFFè¿™ä¸ªå®å®šä¹‰æ¥æ ‡è®°é‚£äº›ä¸åœ¨commit-graph
çš„æ–‡ä»¶ã€‚å¦‚æœä¸€ä¸ªcommit-graphæ–‡ä»¶æ˜¯è¢«ä¸€ä¸ªæ²¡æœ‰è®¡ç®—ä»£æ•°çš„gitç‰ˆæœ¬å†™å…¥çš„ã€‚é‚£ä¹ˆè¿™äº›commitçš„ä»£
æ•°ä¼šè¢«å®å®šä¹‰GENERATION_NUMBER_ZERO = 0æ¥ä»£æ›¿ã€‚</p>

<p>Since the commit-graph file is closed under reachability, we can guarantee
the following weaker condition on all commits:</p>

<p>ç”±äºcommit-graphæ–‡ä»¶åœ¨å¯è¾¾æ€§ä¸‹æ˜¯å…³é—­çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯å¦‚ä¸‹çš„å¼±æ¡ä»¶åœ¨æ‰€æœ‰commitsä¸Šéƒ½å­˜åœ¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">If A and B are commits with generation numbers N amd M, respectively,
and N &lt; M, then A cannot reach B.</pre></td></tr></table>
</div>
</div>
<p>Note how the strict inequality differs from the inequality when we have
fully-computed generation numbers. Using strict inequality may result in
walking a few extra commits, but the simplicity in dealing with commits
with generation number *INFINITY or *ZERO is valuable.</p>

<p>æ³¨æ„ï¼Œå½“æˆ‘ä»¬æœ‰å®Œå…¨è®¡ç®—çš„ä»£æ•°æ—¶å€™ï¼Œä¸¥æ ¼ä¸ç­‰å¼å’Œä¸ç­‰å¼çš„åŒºåˆ«ã€‚ä½¿ç”¨ä¸¥æ ¼ä¸ç­‰å¼å¯èƒ½ä¼šå¯¼è‡´éå†
ä¸€äº›é¢å¤–çš„æäº¤ï¼Œä½†æ˜¯è¿™å¯¹äºå¤„ç†*INFINITY æˆ–è€… *ZEROè¿™ç§ç±»å‹çš„ä»£æ•°æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚</p>

<p>We use the macro GENERATION_NUMBER_MAX = 0x3FFFFFFF to for commits whose
generation numbers are computed to be at least this value. We limit at
this value since it is the largest value that can be stored in the
commit-graph file using the 30 bits available to generation numbers. This
presents another case where a commit can have generation number equal to
that of a parent.</p>

<p>å¯¹äºå¤§äºGENERATION_NUMBER_MAX = 0x3FFFFFFFè¿™ä¸ªå®æ ‡è¯†çš„ä»£æ•°çš„commitï¼Œä¹Ÿæ˜¯ç”¨çš„è¿™ä¸ª
å€¼ã€‚30bitsç”¨æ¥å­˜å‚¨ä»£æ•°ï¼Œæ‰€ä»¥0x3FFFFFFFæ˜¯èƒ½å­˜å‚¨çš„æœ€å¤§å€¼ã€‚è¿™å¸¦æ¥å¦ä¸€ä¸ªé—®é¢˜æ˜¯ä¸€ä¸ªcommit
çš„ä»£æ•°å¯èƒ½ç­‰äºä»–çš„çˆ¶commitã€‚</p>

<p>Design Details</p>

<ul>
<li>The commit-graph file is stored in a file named &lsquo;commit-graph&rsquo; in the
.git/objects/info directory. This could be stored in the info directory
of an alternate.</li>
<li>The core.commitGraph config setting must be on to consume graph files.</li>
<li>The file format includes parameters for the object ID hash function,
so a future change of hash algorithm does not require a change in format.</li>
<li>Commit grafts and replace objects can change the shape of the commit
history. The latter can also be enabled/disabled on the fly using
&ndash;no-replace-objects. This leads to difficultly storing both possible
interpretations of a commit id, especially when computing generation
numbers. The commit-graph will not be read or written when
replace-objects or grafts are present.
on the fly åŠ¨æ€çš„
è¿™å°†ä¸¤ç§æƒ…å†µå¯èƒ½å¯¼è‡´commit idå­˜å‚¨å˜éš¾ï¼Œå°¤å…¶æ˜¯åœ¨è®¡ç®—ä»£æ•°çš„æ—¶å€™ã€‚
å½“commit graftså’Œæ›¿æ¢objectçš„æ—¶å€™ï¼Œcommit-graphä¸å…è®¸è¯»å†™ã€‚</li>
<li>Shallow clones create grafts of commits by dropping their parents. This
leads the commit-graph to think those commits have generation number 1.
If and when those commits are made unshallow, those generation numbers
become invalid. Since shallow clones are intended to restrict the commit
history to a very small set of commits, the commit-graph feature is less
helpful for these clones, anyway. The commit-graph will not be read or
written when shallow commits are present.</li>
</ul>

<p>Future Work</p>

<ul>
<li>After computing and storing generation numbers, we must make graph
walks aware of generation numbers to gain the performance benefits they
enable. This will mostly be accomplished by swapping a commit-date-ordered
priority queue with one ordered by generation number. The following
operations are important candidates:

<ul>
<li>&lsquo;log &ndash;topo-order&rsquo;</li>
<li>&lsquo;tag &ndash;merged&rsquo;</li>
</ul></li>
<li>A server could provide a commit-graph file as part of the network protocol
to avoid extra calculations by clients. This feature is only of benefit if
the user is willing to trust the file, because verifying the file is correct
is as hard as computing it from scratch.</li>
</ul>

<h3 id="å…¶ä»–æ–°é—»">å…¶ä»–æ–°é—»</h3>

<h4 id="git-submodule-æ¼æ´">Git submodule æ¼æ´</h4>

<p>ä»æºç æ¥åˆ†ææ¼æ´çš„åŸå› </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="k">static</span> <span class="kt">int</span> <span class="nf">fsck_gitmodules_fn</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">var</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">vdata</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">fsck_gitmodules_data</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">vdata</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">subsection</span><span class="p">,</span> <span class="o">*</span><span class="n">key</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">subsection_len</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">parse_config_key</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s">&#34;submodule&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">subsection</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">subsection_len</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">key</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span>
	    <span class="o">!</span><span class="n">subsection</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">name</span> <span class="o">=</span> <span class="n">xmemdupz</span><span class="p">(</span><span class="n">subsection</span><span class="p">,</span> <span class="n">subsection_len</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">check_submodule_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">data</span><span class="o">-&gt;</span><span class="n">ret</span> <span class="o">|=</span> <span class="n">report</span><span class="p">(</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">options</span><span class="p">,</span> <span class="n">data</span><span class="o">-&gt;</span><span class="n">obj</span><span class="p">,</span>
				    <span class="n">FSCK_MSG_GITMODULES_NAME</span><span class="p">,</span>
				    <span class="s">&#34;disallowed submodule name: %s&#34;</span><span class="p">,</span>
				    <span class="n">name</span><span class="p">);</span>

    <span class="cm">/* æ–°å¢çš„éæ³•åˆ¤æ–­
</span><span class="cm">    *  æ–°å¢äº†å¯¹pathå’Œurlçš„å‚æ•°æ ¡éªŒ
</span><span class="cm">    */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&#34;url&#34;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">value</span> <span class="o">&amp;&amp;</span>
	    <span class="n">looks_like_command_line_option</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
		<span class="n">data</span><span class="o">-&gt;</span><span class="n">ret</span> <span class="o">|=</span> <span class="n">report</span><span class="p">(</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">options</span><span class="p">,</span> <span class="n">data</span><span class="o">-&gt;</span><span class="n">obj</span><span class="p">,</span>
				    <span class="n">FSCK_MSG_GITMODULES_URL</span><span class="p">,</span>
				    <span class="s">&#34;disallowed submodule url: %s&#34;</span><span class="p">,</span>
				    <span class="n">value</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&#34;path&#34;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">value</span> <span class="o">&amp;&amp;</span>
	    <span class="n">looks_like_command_line_option</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
		<span class="n">data</span><span class="o">-&gt;</span><span class="n">ret</span> <span class="o">|=</span> <span class="n">report</span><span class="p">(</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">options</span><span class="p">,</span> <span class="n">data</span><span class="o">-&gt;</span><span class="n">obj</span><span class="p">,</span>
				    <span class="n">FSCK_MSG_GITMODULES_PATH</span><span class="p">,</span>
				    <span class="s">&#34;disallowed submodule path: %s&#34;</span><span class="p">,</span>
				    <span class="n">value</span><span class="p">);</span>
    <span class="c1">// ç»“æŸ
</span><span class="c1"></span>
	<span class="n">free</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>looks_like_command_line_option(const char *str)</code>æ–¹æ³•çš„å®ç°ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="kt">int</span> <span class="nf">looks_like_command_line_option</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span><span class="p">;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>ä»£ç ä¸ŠåŸºæœ¬ä¸Šå¯ä»¥åˆ¤æ–­å‡ºæ˜¯å› ä¸ºå¯¹submoduleçš„å‚æ•°è§£æä¸Šï¼Œä¹‹å‰æ²¡æœ‰å¯¹-åšæ ¡éªŒï¼Œå¯¼è‡´æ‰§è¡Œçš„æ—¶å€™è¢«ä½œä¸ºå‘½ä»¤æ‰§è¡Œäº†ã€‚</p>

<p>å¦‚ä½•å¤ç°ï¼š</p>

<h3 id="è¯»ç‰©">è¯»ç‰©</h3>

<h4 id="è¯¥æ­»çš„git">è¯¥æ­»çš„Git</h4>

<p><a href="http://dangitgit.com/">åŸæ–‡åœ°å€</a></p>

<p>ä¹ä¸€å¬ï¼Œä»¥ä¸ºæ˜¯åæ§½gitï¼Œä½†å®é™…æ˜¯ä¸€ç¯‡æ•™ä½ å¦‚ä½•å¤„ç†gitä¸­é”™è¯¯æäº¤çš„å¹²è´§~</p>

<p>ä¸ªäººæ„Ÿè§‰æ›´åƒæ˜¯åæ§½gitæ–‡æ¡£çš„~</p>

<blockquote>
<p>Git documentation has this chicken and egg problem where you can&rsquo;t search for how to get yourself out of a mess, unless you already know the name of the thing you need to know about in order to fix your problem.</p>
</blockquote>

<ol>
<li><p>æäº¤äº†ä¸€ä¸ªä¸¥é‡çš„é”™è¯¯ï¼Œæ˜¯å¦æœ‰ç©¿æ¢­å›å»çš„æ—¶å…‰æœºï¼Ÿ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"># ç¬¬ä¸€æ­¥ï¼ŒæŸ¥çœ‹commitçš„å†å²ï¼Œreflogä¼šå±•ç¤ºä½ åœ¨ä»“åº“é‡Œæ‰€æœ‰çš„æ“ä½œï¼ŒåŒ…å«æ‰€æœ‰çš„åˆ†æ”¯
# æ¯ä¸ªå†…å®¹éƒ½æœ‰ä¸€ä¸ªå½¢å¦‚ HEAD@{index} çš„ç´¢å¼•å€¼
# ä½ è¦åšçš„å°±æ˜¯æ‰¾åˆ°ä½ ä¹‹å‰æ²¡æœ‰é—®é¢˜çš„é‚£ä¸ªï¼Œè®°ä¸‹æ¥:)
git reflog
# ç¬¬äºŒæ­¥ï¼Œresetåˆ°è¿™ä¸ªç´¢å¼•æŒ‡å‘çš„ç‰ˆæœ¬
git reset HEAD@{index}
# è¿™å°±æ˜¯å“†å•¦Aæ¢¦çš„ä»»æ„é—¨å•¦</code></pre></td></tr></table>
</div>
</div></li>

<li><p>å½“å·²ç»commitä»¥åï¼Œå‘ç°è¿˜æœ‰äº›ä¸œè¥¿éœ€è¦ä¿®æ”¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"># ç¬¬ä¸€æ­¥ï¼Œåšä½ çš„ä¿®æ”¹ï¼Œç„¶åadd
git add . 
# ç¬¬äºŒæ­¥ï¼Œä¿®æ”¹ä½ æœ€åçš„æäº¤ï¼Œé¡ºå¸¦è¿˜å¯ä»¥é‡æ–°ç¼–è¾‘ä¸‹ä½ çš„commit messageï¼Œæ¯”å¦‚ï¼šæ–°è¡¥å……äº†ä»€ä¹ˆä¸œè¥¿
git commit --amend
# okï¼Œæ–°çš„ä¿®æ”¹å·²ç»æ·»åŠ åˆ°æœ€åä¸€ä¸ªcommité‡Œäº†ï¼Œå¹¶æ²¡æœ‰äº§ç”Ÿæ–°çš„commitï¼Œä¸€åˆ‡è¿˜æ˜¯é‚£ä¹ˆçš„å¹²å‡€</code></pre></td></tr></table>
</div>
</div></li>

<li><p>å‘ç°commit messageå†™çš„ä¸å°½äººæ„ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git">git commit --amend</code></pre></td></tr></table>
</div>
</div></li>

<li><p>æœ¬æ¥åº”è¯¥ä»masteræ–°å»ºä¸€ä¸ªåˆ†æ”¯åšä¿®æ”¹çš„ï¼Œç»“æœç›´æ¥æäº¤åˆ°äº†master</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"># ç¬¬ä¸€æ­¥ï¼Œå…ˆä»masterä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ï¼ˆæ­¤æ—¶ä½ çš„ä¿®æ”¹å·²ç»è¯¯æäº¤åˆ°masterä¸Šäº†å“ˆï¼‰
git branch some-new-branch-name
# ç¬¬äºŒæ­¥ï¼Œä»masterä¸ŠæŠ¹æ‰ä½ çš„ä¿®æ”¹
git reset HEAD~ --hard
# ç¬¬ä¸‰æ­¥ï¼Œåˆ‡æ¢åˆ°ä½ åœ¨ç¬¬ä¸€æ­¥åˆ›å»ºçš„åˆ†æ”¯
git checkout some-new-branch-name
# Duangï¼Œä½ çš„æäº¤å·²ç»åœ¨è¿™ä¸ªæ–°åˆ†æ”¯ä¸Šäº†</code></pre></td></tr></table>
</div>
</div></li>

<li><p>ä¸4ç±»ä¼¼ï¼Œä½†è¿™æ¬¡æ˜¯æŠŠä¿®æ”¹æäº¤äº†é”™è¯¯çš„åˆ†æ”¯ä¸Šï¼ˆæœ¬æ¥ä½ è¦æäº¤çš„åˆ°å·²å­˜åœ¨çš„featureåˆ†æ”¯ï¼Œç»“æœæäº¤åˆ°masterä¸Šäº†ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"># ç¬¬ä¸€æ­¥ï¼Œæ’¤å›ä½ çš„æäº¤ï¼Œä½†æ˜¯è¦ä¿æŒä½ è¿™äº›æäº¤æ˜¯å¯ç”¨çš„ï¼Œæ³¨æ„ï¼ï¼ï¼è¿™é‡ŒåŒºåˆ«äº4ä¸­çš„--hard
git reset HEAD~ --soft
# ç¬¬äºŒæ­¥ï¼ŒæŠŠä½ çš„æäº¤æ¨åˆ°ç¼“å­˜é‡Œ
git stash
# ç¬¬ä¸‰æ­¥ï¼Œåˆ‡æ¢åˆ°æ­£å–çš„åˆ†æ”¯
git checkout name-of-the-correct-branch
# ç¬¬å››æ­¥ï¼Œä»ç¼“å­˜é‡ŒæŠŠåˆšæ‰çš„æäº¤å†…å®¹å–å‡ºæ¥
git stash pop
# ç¬¬äº”æ­¥ï¼Œåœ¨å½“å‰åˆ†æ”¯ä¸‹æ·»åŠ ä¿®æ”¹çš„å†…å®¹
git add . # or add individual files
# ç¬¬å…­æ­¥ï¼Œæ„‰å¿«çš„åšä¸€ä¸ªæäº¤
git commit -m &#34;your message here&#34;
# è‡³æ­¤ï¼Œä½ çš„æ”¹åŠ¨çš„å†…å®¹å·²ç»å›åˆ°äº†æ­£ç¡®çš„åˆ†æ”¯</code></pre></td></tr></table>
</div>
</div>
<p>å¯èƒ½æœ‰äº›åŒå­¦è¿·ç³Š4å’Œ5æœ‰å•¥åŒºåˆ«ï¼ŸåŒºåˆ«åœ¨äºï¼Œ4æ˜¯æŠŠå†…å®¹ä»é”™è¯¯æäº¤çš„åˆ†æ”¯è½¬åˆ°æ–°åˆ†æ”¯ä¸Šï¼Œ5æ˜¯æŠŠå†…å®¹ä»é”™è¯¯æäº¤çš„åˆ†æ”¯è½¬ç§»åˆ°å·²å­˜åœ¨çš„åˆ†æ”¯ã€‚</p>

<p>å’±çš„åŸåˆ™æ˜¯æœ€å¥½ä¸è¦åšåˆ é™¤åˆ†æ”¯çš„æ“ä½œæ¥è¿›è¡Œå˜æ¢å“ˆï¼Œå¤©çŸ¥é“ä½ å·²å­˜åœ¨çš„åˆ†æ”¯æ˜¯ä¸æ˜¯è¿˜æœ‰å…¶ä»–æœªæäº¤åˆ°è¿œç«¯çš„å†…å®¹å‘¢ï¼Ÿ</p>

<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›éªšæ“ä½œå¯ä»¥å®Œæˆè¿™ä¸ªéœ€æ±‚å‘¢ï¼Ÿ<code>cherrry pick</code>ä¹Ÿå¯ä»¥åšè¿™ä¸ªåŠŸèƒ½ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git">git checkout name-of-the-correct-branch
# grab the last commit to master
git cherry-pick master
# delete it from master
git checkout master
git reset HEAD~ --hard</code></pre></td></tr></table>
</div>
</div></li>

<li><p>æˆ‘è¿è¡Œäº†<code>git diff</code>,å±…ç„¶æ²¡æœ‰ååº”
æ˜æ˜æœ¬åœ°æœ‰æ”¹åŠ¨çš„å†…å®¹ï¼Œä½†æ˜¯diffæ²¡æœ‰ååº”ã€‚</p>

<p>è¿™ä¸ªæ˜¯å› ä¸ºä½ æœ¬åœ°çš„ä¿®æ”¹å·²ç»æ‰§è¡Œè¿‡addï¼Œè¿›å…¥äº†stagedçŠ¶æ€ï¼Œå¦‚æœä¸åŠ <code>--staged</code>å‚æ•°ï¼Œdiffæ˜¯ä¸ä¼šå¯¹è¿™äº›æ–‡ä»¶æ“ä½œçš„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git">git diff --staged</code></pre></td></tr></table>
</div>
</div></li>

<li><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ”¾å¼ƒæœ¬åœ°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-git" data-lang="git">cd ..
sudo rm -r dang-git-repo-dir
git clone https://some.github.url/dang-git-repo-dir.git
cd dang-git-repo-dir</code></pre></td></tr></table>
</div>
</div>
<p>å¬ğŸ‘‚ï¼Œä¸–ç•Œéƒ½æ¸…å‡€äº†&hellip;</p></li>
</ol>

<h4 id="å¯¹å¼€æºè½¯ä»¶ç»´æŠ¤è€…æœ‰ç”¨çš„20ä¸ªå·¥å…·">å¯¹å¼€æºè½¯ä»¶ç»´æŠ¤è€…æœ‰ç”¨çš„20ä¸ªå·¥å…·</h4>

<p><a href="https://hackernoon.com/20-useful-tools-for-open-source-maintainers-ee86a09e04e5">åŸæ–‡é“¾æ¥</a></p>

<p>emmï¼Œéƒ½æ˜¯githubä¸Šç»´æŠ¤å¼€æºç¤¾åŒºç”¨çš„ï¼ŒåŒ…å«å¸¸ç”¨çš„Travis CI, Jenkinsç­‰ã€‚åœ¨å¤§é˜¿é‡Œç»æµä½“å†…ï¼Œå¤§å®¶ç”¨Aoneå°±å¥½äº†ï¼</p>

<p>ä¸è¿‡æœ‰è‡ªå·±é¡¹ç›®æˆ–å¼€æºé¡¹ç›®åœ¨githubä¸Šç»´æŠ¤çš„ï¼Œå¯ä»¥çœ‹ä¸‹ã€‚</p>

<h4 id="å¦‚ä½•é«˜æ•ˆçš„ä½¿ç”¨git">å¦‚ä½•é«˜æ•ˆçš„ä½¿ç”¨Git</h4>

<p><a href="https://dev.to/adityasridhar/how-to-use-git-efficiently-2pfa">åŸæ–‡é“¾æ¥</a></p>

<p>ä¸»è¦è®²è¿°git workflowçš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±è¯»ä¸‹ã€‚</p>

<h3 id="gitå·¥å…·å’Œç›¸å…³ç½‘ç«™">gitå·¥å…·å’Œç›¸å…³ç½‘ç«™</h3>

<h4 id="git-fire">git-fire</h4>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">berger7</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">2019-01-20</span>
  </p>
  
  
</div><footer class="post-footer">
      
      <nav class="post-nav">
        
        <a class="next" href="/post/vim-learn-20190120/">
            <span class="next-text nav-default">vimæŒ‡ä»¤å­¦ä¹ â€”â€”20190120</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:bojun.cbj@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/Berger7" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://weibo.com/p/1005056077470366" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/people/142397030" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">berger7</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>








</body>
</html>
